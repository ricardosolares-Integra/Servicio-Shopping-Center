CREATE COLUMN TABLE NOMBREDB."T_ARTICULO" (
	"IdArticulo" NVARCHAR(20),
	"Descripcion" NVARCHAR(100) NOT NULL,
	"IdGrupo" NVARCHAR(100) NOT NULL,
	"EsCompra" BOOLEAN CS_INT NOT NULL,
	"EsVenta" BOOLEAN CS_INT NOT NULL,
	"UniMedida" NUMERIC(6) NOT NULL,
	"Bodega" NVARCHAR(8),
	"CodigoBarras" NVARCHAR(100),
	"Estado" NVARCHAR(1) NOT NULL,
	"FechaCreacion" LONGDATE CS_LONGDATE DEFAULT CURRENT_TIMESTAMP,
	"Enviar" BOOLEAN CS_INT DEFAULT TRUE NOT NULL,
	"Enviado" BOOLEAN CS_INT DEFAULT FALSE NOT NULL,
	"ItemCodeSap" NVARCHAR(50),
	"Intento" INT NOT NULL DEFAULT 0,	
    CONSTRAINT "PK_T_ARTICULO" PRIMARY KEY ("IdArticulo")
);

CREATE COLUMN TABLE NOMBREDB."T_FACTURACLI" (
	"IdFactura" NVARCHAR(15),
	"CodigoCliente" NVARCHAR(15) NOT NULL,
	"FechaDocumento" DATETIME NOT NULL,
	"Bodega" NVARCHAR(8) NOT NULL,
	"TipoDTE" NVARCHAR(2) NOT NULL,
	"NumeroControl" NVARCHAR(50),
	"CodigoGeneracion" NVARCHAR(50),
	"SelloMH" NVARCHAR(50),
	"NumeroControl_Del" NVARCHAR(50),
	"NumeroControl_Al" NVARCHAR(50),
	"Correlativo_Del" NVARCHAR(50),
	"Correlativo_Al" NVARCHAR(50),
	"Serie_Del" NVARCHAR(50),
	"Serie_Al" NVARCHAR(50),
	"TipoDocIdentificacion" NVARCHAR(2) NOT NULL,
 	"NIT" NVARCHAR(20),
	"NRC" NVARCHAR(20),
	"Nombre" NVARCHAR(100),
	"Direccion_Complemento" NVARCHAR(250),
	"Direccion_Departamento" NVARCHAR(20),
	"Direccion_Municipio" NVARCHAR(20),
	"CodigoActividadEconomica" NVARCHAR(10),
	"DescActividadEconomica" NVARCHAR(150),
	"Correo" NVARCHAR(250),
	"PuntoVenta" NVARCHAR(4),
	"Establecimiento" NVARCHAR(4),
	"FechaCreacion" LONGDATE CS_LONGDATE DEFAULT CURRENT_TIMESTAMP,
	"Enviar" BOOLEAN CS_INT DEFAULT FALSE NOT NULL,
	"Enviado" BOOLEAN CS_INT DEFAULT FALSE NOT NULL,
	"SapDocEntry" INTEGER CS_INT,
	"Intento" INT NOT NULL DEFAULT 0,	
    CONSTRAINT "PK_T_FACTURACLI" PRIMARY KEY ("IdFactura")
);

CREATE COLUMN TABLE NOMBREDB."T_FACTURACLI_FILAS" (
	"IdFactura" NVARCHAR(15),
	"Fila" INTEGER,
	"IdArticulo" NVARCHAR(20) NOT NULL,
	"CodigoImpuesto" NVARCHAR(10) NOT NULL,
	"Descripcion" NVARCHAR(250),
	"CodigoBarras" NVARCHAR(20),
	"DescripcionCB" NVARCHAR(250),
	"PreciodLista" Numeric NOT NULL,
	"PrecioUnitario" Numeric NOT NULL,
	"Cantidad" INTEGER NOT NULL,
	"Moneda" NVARCHAR(3) NOT NULL,
	"Monto" DECIMAL(19, 6) NOT NULL,
	"CuentaAsociada" NVARCHAR(50) NOT NULL,
	"FechaCreacion" LONGDATE CS_LONGDATE DEFAULT CURRENT_TIMESTAMP,
	"Enviar" BOOLEAN CS_INT DEFAULT FALSE NOT NULL,
	"Enviado" BOOLEAN CS_INT DEFAULT FALSE NOT NULL,
	"SapDocEntry" INTEGER CS_INT,
    CONSTRAINT "PK_T_FACTURACLI_FILAS" PRIMARY KEY ("IdFactura", "IdArticulo"),
    CONSTRAINT "CHK_T_FACTURACLI_FILAS_MONEDA" CHECK ("Moneda" IN ('QTZ', 'USD')),
    CONSTRAINT "FK_MD_FACTURACLI" FOREIGN KEY ("IdFactura") REFERENCES NOMBREDB."T_FACTURACLI" ("IdFactura")
);


CREATE COLUMN TABLE NOMBREDB."T_CATALOGO_ERRORES" (
	"IdError" INTEGER CS_INT NOT NULL,
	"Descripcion" NVARCHAR(1024) NOT NULL,
	CONSTRAINT "PK_T_CATALOGO_ERRORES" PRIMARY KEY ("IdError")
);

CREATE COLUMN TABLE NOMBREDB."T_PARAMETROS" (
	"Codigo" INTEGER CS_INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	"Nombre" NVARCHAR(50) NOT NULL,
	"Valor" NVARCHAR(100) NOT NULL,
	"Descripcion" NVARCHAR(100) NOT NULL,
	CONSTRAINT "PK_T_PARAMETROS" PRIMARY KEY ("Codigo")
);

CREATE COLUMN TABLE NOMBREDB."T_PARAMETROS_ENVIO" (
	"IdServicio" NVARCHAR(50) NOT NULL,
	"Ejecucion" NVARCHAR(1) NOT NULL,
	"DiasEjecucion" NVARCHAR(50) NOT NULL,
	"TipoEnvio" NVARCHAR(30) NOT NULL,
	"Horario" NVARCHAR(50) NOT NULL,
	"TiempoEspera" INTEGER CS_INT NOT NULL
);

CREATE COLUMN TABLE NOMBREDB."T_TIPO_OBJETO" (
	"IdTipoObjetoSap" INTEGER CS_INT NOT NULL,
	"Nombre" NVARCHAR(50) NOT NULL,
	"Descripcion" NVARCHAR(50) NOT NULL,
	"NombreCampo" VARCHAR(100) NOT NULL,
	"NombreTabla" NVARCHAR(50) NOT NULL,
	"Orden" INTEGER CS_INT NOT NULL,
	"EnvioManual" VARCHAR(2) NOT NULL,
	"EnEjecucion" BOOLEAN NOT NULL DEFAULT FALSE,
	"Estado" VARCHAR(1) NULL,	
	CONSTRAINT "PK_T_TIPO_OBJETOS" PRIMARY KEY ("IdTipoObjetoSap")
);

CREATE COLUMN TABLE NOMBREDB."T_BITACORA" (
	"Correlativo" INTEGER CS_INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	"IdTipoObjetoSap" INTEGER CS_INT NOT NULL,
	"Fecha" LONGDATE CS_LONGDATE DEFAULT CURRENT_TIMESTAMP NOT NULL,
	"ResultadoTransaccion" NVARCHAR(10) NOT NULL,
	"IdObjetoSap" INTEGER CS_INT,
	"IdObjetoIntermedia" NVARCHAR(254),
	"IdError" INTEGER CS_INT,
	"Mensaje" CLOB MEMORY THRESHOLD 1000 NOT NULL,
	"TipoTransaccion" NVARCHAR(25) NOT NULL,
	"TipoOperacion" NVARCHAR(25) NOT NULL,
	CONSTRAINT "PK_T_BITACORA" PRIMARY KEY ("Correlativo"),
	CONSTRAINT "CHK_T_BITACORA_RESULTADO" CHECK (
		"ResultadoTransaccion" IN ('Fallido', 'Exitoso')
	),
	CONSTRAINT "CHK_T_BITACORA_TTRANSACCION" CHECK ("TipoTransaccion" IN ('SAP', 'Intermedia')),
	CONSTRAINT "CHK_T_BITACORA_TOPERACION" CHECK (
		"TipoOperacion" IN ('Crear', 'Actualizar', 'Eliminar', 'Listar')
	),
    CONSTRAINT "FK_IDERROR_BITACORA" FOREIGN KEY ("IdError") REFERENCES NOMBREDB."T_CATALOGO_ERRORES" ("IdError"),
    CONSTRAINT "FK_TIPOOBJETO_BITACORA" FOREIGN KEY ("IdTipoObjetoSap") REFERENCES NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap")
);

CREATE COLUMN TABLE NOMBREDB."T_LOG_CONSUMO_SL" (
	"Correlativo" INTEGER CS_INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	"IdTipoObjetoSap" INTEGER CS_INT NOT NULL,
	"Fecha" LONGDATE CS_LONGDATE DEFAULT CURRENT_TIMESTAMP NOT NULL,
	"BdSap" NVARCHAR(50) NOT NULL,
	"MetodoHtml" NVARCHAR(10),
	"Url" NVARCHAR(5000) NOT NULL,
	"Request" CLOB MEMORY THRESHOLD 1000,
	"Response" CLOB MEMORY THRESHOLD 1000,
	CONSTRAINT "PK_T_LOG_CONSUMO_SL" PRIMARY KEY ("Correlativo"),
    CONSTRAINT "FK_TIPOOBJETO_LOG_CONSUMO_SL" FOREIGN KEY ("IdTipoObjetoSap") REFERENCES NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap")
);
COMMIT;

INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('NivelLog','1','Indica el nivel de escritura del Log. Valores (0=Error, 1=Info, 2=Debugg)');
INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('SNCliente','CL00032','Indica el codigo del socios de negocios cliente');
INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('SNVendedor','V10000','Indica el codigo del socios de negocios vendedor');
INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('CPagoProv','Contado Estricto','Indica la condicion de pago del socio de negocios vendedor');
INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('SerieProv','Locales','Indica la descripcion de la serie del socio de negocios vendedor');
INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('WHCentral','01','Indica almacen central');
INSERT INTO NOMBREDB."T_PARAMETROS" ("Nombre","Valor","Descripcion") VALUES ('MaxIntentos','5','Maximo de intentos permitidos por documento');
COMMIT;

INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (1,'Error general, no controlado.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (2,'No existe una conexión valida o no se encuentra configurado los parámetros SAP.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (3,'La estructura del objeto es incorrecta.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (10,'No se ha asignado el tipo de cambio.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (12,'El codigo de artículo ya existe en SAP.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (14,'Propiedad ingresada Y/N invalida.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (15,'Codigo de cliente existente. No se admiten codigos duplicados.');
INSERT INTO NOMBREDB."T_CATALOGO_ERRORES" ("IdError","Descripcion") VALUES (-1,'Exitoso');
COMMIT;

INSERT INTO NOMBREDB."T_PARAMETROS_ENVIO" ("IdServicio","Ejecucion","DiasEjecucion","TipoEnvio","Horario","TiempoEspera") VALUES ('-1','3','1,1,0,1,0,1,0','1','12:00,18:00,21:00',100);
COMMIT;

INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (4,'Articulos','Articulos varios','IdArticulo,Descripcion,IdGrupo,Estado','T_ARTICULO',1,'0','A');	
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (2,'Proveedor','Business Partner','CodigoProveedor,RazonSocial,NombreComercial,IdGrupo,Nit,Telefono,Direccion,Estado','T_PROVEEDOR',2,'0','I');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (13,'Factura Deudores','A/R Invoice','IdFactura,FechaDocumento,NIT,Nombre,Intento','T_FACTURACLI',3,'0','A');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (18,'Factura Compras','A/P Invoice','SapDocEntry,FechaDocumento','T_FACTURACOM',4,'0','I');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (14,'Nota Credito','A/R Credit Memo','Bodega,CantidadNotasCredito,FechaDocumento,SapDocEntry','T_NOTACREDITO',5,'0','I');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (24,'Pagos Recibidos','Incoming Payment','IdFactura,FechaDocumento,Moneda,Monto,TipoPago,SapDocEntry','T_FACTURACLI_PAGO',6,'0','I');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (1250000001,'Solicitud Traslado Materia','Inventory Transfer Request','IdSolicitud,BodegaEmisora,BodegaReceptora,FechaDocumento,SapDocEntry','T_SOLICITUD_TRASLADO',7,'0','I');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (67,'Traslado Materia','Inventory Transfer','IdTraslado,BodegaEmisora,BodegaReceptora,FechaDocumento,SapDocEntry','T_CONFIRMACION_TRASLADO',8,'0','I');
INSERT INTO NOMBREDB."T_TIPO_OBJETO" ("IdTipoObjetoSap","Nombre","Descripcion","NombreCampo","NombreTabla","Orden","EnvioManual","Estado") VALUES (60,'Salida Mercanica','Consumo Materia','FechaDocumento,Bodega,SapDocEntry','T_CONSUMO_MATERIA',9,'0','I');
COMMIT;